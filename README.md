# addressfilter
도로명 필터링 시스템

- 
    - 고려사항들
        1. 도로명 추출 방식
            1. 정규표현식으로 추출 ✅
            2. 도로명검색 Open API활용
        2. 추출한 도로명이 도로명인지 아닌지 어떻게 판단?
            1. 국내 전체 도로명 데이터를 가져와서 추출값과 대조하여 판단 ✅
        3. 국내 도로명 데이터를 어떻게 받아올 것이냐
            1. 공공데이터 OpenAPI
            2. 주소정보포털 도로명 파일 다운 ✅
        4. 가져온 데이터를 어떻게 다룰 것이냐, 검색
            1. 애플리케이션 메모리 단 핸들링 ✅
            2. DB 인덱스 테이블 설계
        5. DB에 삽입 시 txt파일에서 도로명 추출 방법
            1. BufferedInputStream + StringTokenizer ✅
            2. BufferedInputStream + String.split()
            3. 도로명 중복데이터 제거를 위해 HashSet사용 ✅
        6. 자바에서 DB접근 기술은 어떤 것을 사용
            1. JPA
            2. QueryDSL
            3. JDBC
            
            → 미사용
            
    - 정규표현식 추출된 문자열 핸들링
        1. 정규식으로 해당하는 문자열 리스트 반환
        2. 해당 리스트 요소에서 공백,특문 제거하고 “~로”로 끝나는 문자가 있는 인덱스 찾기
            1. “~로”로 끝나지만 길이가 3이하일 경우 최소 길이 3이 될 때까지 직전 문자와 합치기
        3. “~로”로 끝나면 인접한 바로 다음 인덱스의 문자열이 숫자이거나 숫자+길로 끝나는 지확인하여 맞으면 문자열 합치기
        4. 위 조건에 해당하는 문자열 없으면 “~길”로 끝나는 문자가 있는 인덱스 찾기
            1. “~길”로 끝나지만 길이가 3이하일 경우 최소 길이 3이 될 때까지 직전 문자와 합치기
        5. 최종적으로 완성된 도로명 roadNameData Set에서 찾기
        6. 탐색 결과 있으면 해당 도로명 반환
        7. 탐색 결과 없으면 특수문자를 포함하는 도로명 데이터 specialRoadNameData Map에서 찾기
        8. 있으면 해당도로명 반환, 없으면 빈 도로명 반환
    - 작업 기록
        - 전체 도로명 데이터 출처([https://www.code.go.kr/index.do](https://www.code.go.kr/index.do))
        - 전체 도로명 데이터를 DB로 관리하며 존재여부를 체크하려 했으나.. 대량 데이터 처리시 생각보다 시간이 많이 걸리고 인덱스를 적용해도 개선이 되지 않음. 단일 스키마 테이블에 기본키를 통한 검색이라 풀스캔이나 인덱스 스캔이나 큰 차이 없는 것으로 보임.
        - 그래서 DB말고 자바 메모리에서 데이터를 관리할 방법을 생각해봐야함. 전체 도로명 데이터는 약 2MB정도로 추정되는데, 이걸 스태틱메모리 영역에 올려도 괜찮을지?
        - 1800건 가량의 주소에 대한 테스트 수행결과..
            - DB탐색 방식 : 12~13초 가량
            - static HashSet 탐색 방식 : 0.2초 가량
        - 도로명에 특수문자가 안 들어가는 줄 알았으나.. 점(.)이나 중간점(∙)이 들어가는 도로명들이 존재하여 특수문자가 포함되는 도로명을 따로 HashMap으로 관리하기로 함
        - 대량의 주소목록이라는 조건이 있어, 처리성능 향상을 위해 멀티스레드를 적용하였다. 멀티스레드 적용시 10만건 기준 약 30% 속도향상, 100만건 기준 약 60% 속도향상이 있었음.
        - 전체 도로명 데이터가 변경될 수 있기 때문에 도로명 데이터를 업데이트하는 일별 배치를 돌리는 게 좋을 듯하나.. 구현시간 부족
        - 확인해보니 도로명 데이터가 시군구가 다르다면 중복될 수 있다… 사용자의 시군구 입력값도 추출하여 검색해보는 게 좋을 듯 하지만 이것도 시간이 없다..
